
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>YouTube Watch (nocookie embed) + Safe Download</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --accent: #2563eb;
      --bg: #0b1020;
      --panel: #0f172a;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --error: #ef4444;
      --ok: #22c55e;
    }
    html, body {
      height: 100%;
      margin: 0;
      background: radial-gradient(1200px 600px at 20% 0%, #141b38 0, #0b1020 70%, #070a14 100%);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Inter, Arial, "Noto Sans";
    }
    .wrap {
      max-width: 720px;
      margin: 6vh auto;
      padding: 24px;
    }
    h1 { font-size: 1.25rem; margin: 0 0 12px 0; font-weight: 600; }
    .controls {
      display: flex; gap: 10px; align-items: center;
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border: 1px solid rgba(148,163,184,0.22);
      border-radius: 14px;
      padding: 10px;
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.06),
        0 8px 30px rgba(2,6,23,0.55),
        0 2px 8px rgba(2,6,23,0.2);
      backdrop-filter: blur(6px);
    }
    .controls input[type="url"] {
      flex: 1; padding: 12px 14px;
      border: 1px solid rgba(148,163,184,0.28);
      background: rgba(15,23,42,0.85);
      color: var(--text);
      border-radius: 10px;
      outline: none; font-size: 14px;
      transition: border-color 0.15s ease, box-shadow 0.15s ease;
    }
    .controls input[type="url"]::placeholder { color: var(--muted); }
    .controls input[type="url"]:focus {
      border-color: rgba(37,99,235,0.7);
      box-shadow: 0 0 0 3px rgba(37,99,235,0.18);
    }
    .btn {
      padding: 12px 16px;
      background: linear-gradient(180deg, #2f6fe9, #2056c7);
      color: white; border: none; border-radius: 10px;
      font-weight: 600; letter-spacing: 0.2px; cursor: pointer; white-space: nowrap;
      transition: transform 0.05s ease, box-shadow 0.15s ease, filter 0.15s ease;
      box-shadow: 0 8px 20px rgba(37,99,235,0.25), inset 0 1px 0 rgba(255,255,255,0.2);
    }
    .btn:hover {
      filter: brightness(1.05);
      box-shadow: 0 12px 26px rgba(37,99,235,0.32), inset 0 1px 0 rgba(255,255,255,0.22);
    }
    .btn:active { transform: translateY(1px); }
    .btn.secondary {
      background: linear-gradient(180deg, #374151, #1f2937);
      box-shadow: 0 8px 20px rgba(17,24,39,0.25), inset 0 1px 0 rgba(255,255,255,0.12);
    }
    .hint { margin: 8px 4px 16px 4px; font-size: 13px; color: var(--muted); }
    .error { margin: 8px 4px 0 4px; font-size: 13px; color: var(--error); display: none; }
    .ok { margin: 8px 4px 0 4px; font-size: 13px; color: var(--ok); display: none; }

    /* 16:9 player box */
    .player-wrap {
      width: min(560px, 100%);
      aspect-ratio: 16 / 9;
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid rgba(148,163,184,0.22);
      background: #000;
      box-shadow:
        0 20px 50px rgba(2,6,23,0.65),
        0 8px 20px rgba(2,6,23,0.35);
      margin-top: 16px;
    }
    .player-wrap iframe {
      width: 100%; height: 100%; border: 0; display: block;
    }

    .row { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; margin-top: 10px; }
    .meta { font-size: 12px; color: var(--muted); user-select: text; }
    @media (max-width: 480px) {
      .wrap { padding: 16px; }
      .controls { flex-direction: column; }
      .btn { width: 100%; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Watch a YouTube video (privacy‑enhanced embed)</h1>

    <div class="controls">
      <input
        id="ytUrl"
        type="url"
        inputmode="url"
        placeholder="Paste a YouTube link (e.g., https://www.youtube.com/watch?v=LXb3EKWsInQ)"
        aria-label="YouTube URL"
        autofocus
      />
      <button id="watchBtn" class="btn" type="button" aria-label="Watch video">Watch</button>
      <button id="downloadBtn" class="btn secondary" type="button" aria-label="Download embed HTML">Download</button>
    </div>

    <div id="hint" class="hint">
      Paste a YouTube URL and press <b>Watch</b> (or hit <kbd>Enter</kbd>).
    </div>
    <div id="error" class="error">Sorry—couldn’t find a valid YouTube video ID in that link.</div>
    <div id="ok" class="ok">Embed HTML downloaded.</div>

    <!-- 16:9 player (initial placeholder ID Zy4oPoCDU4I; replaced when you press Watch) -->
    <div class="player-wrap">
      <iframe
        id="player"
        width="560"
        height="315"
        src="https://www.youtube-nocookie.com/embed/Zy4oPoCDU4I"
        title="Videoplayback"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        referrerpolicy="strict-origin-when-cross-origin"
        allowfullscreen
      ></iframe>
    </div>

    <div class="row">
      <div class="meta">Current video ID: <code id="vidId">Zy4oPoCDU4I</code></div>
      <button id="copyEmbedBtn" class="btn secondary" type="button" aria-label="Copy embed HTML">Copy Embed</button>
      <button id="openYTBtn" class="btn secondary" type="button" aria-label="Open on YouTube">Open on YouTube</button>
    </div>

    <div class="hint" style="margin-top:8px;">
      <b>Note:</b> This app provides a safe <em>embed</em> download only.
      It <b>does not download videos</b> (including movies), to respect rights and platform policies.
    </div>
  </div>

  <script>
    /** Extract a YouTube video ID from common URL types. */
    function extractYouTubeId(input) {
      if (!input) return null;
      const str = String(input).trim();
      const idPattern = /^[a-zA-Z0-9_-]{11}$/;
      if (idPattern.test(str)) return str;

      let url;
      try {
        url = new URL(str);
      } catch {
        try {
          url = new URL("https://" + str);
        } catch {
          return null;
        }
      }

      // watch?v=ID
      const vParam = url.searchParams.get("v");
      if (vParam && idPattern.test(vParam)) return vParam;

      // youtu.be/ID
      if (/^(.+\.)?youtu\.be$/i.test(url.hostname)) {
        const seg = url.pathname.split("/").filter(Boolean)[0];
        if (seg && idPattern.test(seg)) return seg;
      }

      // /embed/ID
      const embedMatch = url.pathname.match(/\/embed\/([a-zA-Z0-9_-]{11})/);
      if (embedMatch) return embedMatch[1];

      // /shorts/ID
      const shortsMatch = url.pathname.match(/\/shorts\/([a-zA-Z0-9_-]{11})/);
      if (shortsMatch) return shortsMatch[1];

      // Fallback: first 11-char token that looks like an ID
      const anyMatch = str.match(/[a-zA-Z0-9_-]{11}/g);
      if (anyMatch) return anyMatch[0];

      return null;
    }

    function currentId() {
      return document.getElementById("vidId").textContent.trim();
    }

    function setVideoById(id) {
      const iframe = document.getElementById("player");
      const metaSpan = document.getElementById("vidId");
      const src = `https://www.youtube-nocookie.com/embed/${id}?autoplay=1&rel=0`;
      iframe.src = src; // reload and play
      metaSpan.textContent = id;
    }

    function handleWatch() {
      const input = document.getElementById("ytUrl");
      const error = document.getElementById("error");
      const hint = document.getElementById("hint");
      const ok = document.getElementById("ok");

      ok.style.display = "none";
      const id = extractYouTubeId(input.value);
      if (!id) {
        error.style.display = "block";
        hint.style.display = "none";
        return;
      }
      error.style.display = "none";
      hint.style.display = "none";
      setVideoById(id);
    }

    // Safe "download": produce a tiny HTML file with the embed iframe.
    function downloadEmbedHtml() {
      const id = currentId();
      const error = document.getElementById("error");
      const ok = document.getElementById("ok");
      error.style.display = "none";
      ok.style.display = "none";

      if (!id || !/^[a-zA-Z0-9_-]{11}$/.test(id)) {
        error.textContent = "No valid video selected to create embed.";
        error.style.display = "block";
        return;
      }

      // Create a minimal, privacy-enhanced embed HTML snippet
      const snippet = [
        "<!-- YouTube privacy‑enhanced embed (no-cookie) -->",
        `<iframe width="1162" height="558" src="https://www.youtube-nocookie.com/embed/${id}"`,
        `  title="YouTube video" frameborder="0"`,
        `  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"`,
        `  referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
        ""
      ].join("\n");

      const htmlDoc = [
        "<!doctype html>",
        "<html><head><meta charset='utf-8'><title>Embed</title></head><body>",
        snippet,
        "</body></html>"
      ].join("\n");

      const blob = new Blob([htmlDoc], { type: "text/html;charset=utf-8" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = `embed-${id}.html`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(a.href);

      ok.textContent = "Embed HTML downloaded.";
      ok.style.display = "block";
    }

    // Copy current embed HTML to clipboard (convenience).
    async function copyEmbedToClipboard() {
      const id = currentId();
      if (!id) return;
      const snippet = `<iframe width="1162" height="558" src="https://www.youtube-nocookie.com/embed/${id}" title="YouTube video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`;
      try {
        await navigator.clipboard.writeText(snippet);
        const ok = document.getElementById("ok");
        ok.textContent = "Embed HTML copied to clipboard.";
        ok.style.display = "block";
      } catch {
        const error = document.getElementById("error");
        error.textContent = "Clipboard blocked by browser permissions.";
        error.style.display = "block";
      }
    }

    // Open the canonical watch URL in a new tab (users with YouTube Premium can use the official Download feature there).
    function openOnYouTube() {
      const id = currentId();
      if (!id) return;
      window.open(`https://www.youtube.com/watch?v=${id}`, "_blank", "noopener,noreferrer");
    }

    // Hook up events
    document.getElementById("watchBtn").addEventListener("click", handleWatch);
    document.getElementById("downloadBtn").addEventListener("click", downloadEmbedHtml);
    document.getElementById("copyEmbedBtn").addEventListener("click", copyEmbedToClipboard);
    document.getElementById("openYTBtn").addEventListener("click", openOnYouTube);
    document.getElementById("ytUrl").addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        handleWatch();
      }
    });
  </script>
</body>
</html>
